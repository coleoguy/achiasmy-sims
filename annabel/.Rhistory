Sex = rep(c("F", "M"), times = 2*gen_no),
"Count of F-Benefit SAL" = rep(NA, times = 2*gen_no),
"Count of M-Benefit SAL" = rep(NA, times = 2*gen_no)
)
SAL.counter
g
indv
results[[g]][[indv]]
sum(c(results[[g]][[indv]][,28] == 0, results[[g]][[indv]][,55] == 0))
# For each generation, count number of MALES and number of FEMALES with SAL
SAL.counter <- data.frame(
Generation = rep(1:gen_no, each = 2),
Sex = rep(c("F", "M"), times = 2*gen_no),
"Count of F-Benefit SAL" = rep(NA, times = 2*gen_no),
"Count of M-Benefit SAL" = rep(NA, times = 2*gen_no)
)
for(g in 1:gen_no){
for(indv in 1:pop_size){
# Record sex and SAL of each individual
if(sum(results[[g]][[indv]][,13]) == 0){
SAL.counter$Count.of.F.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "F"] <- SAL.counter$Count.of.F.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "F"] + sum(c(results[[g]][[indv]][,28] == 0, results[[g]][[indv]][,55] == 0))
SAL.counter$Count.of.M.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "F"] <- SAL.counter$Count.of.M.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "F"] + sum(c(results[[g]][[indv]][,28] == 1, results[[g]][[indv]][,55] == 1))
}else{
SAL.counter$Count.of.F.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "M"] <- SAL.counter$Count.of.F.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "M"] + sum(c(results[[g]][[indv]][,28] == 0, results[[g]][[indv]][,55] == 0))
SAL.counter$Count.of.M.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "M"] <- SAL.counter$Count.of.M.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "M"] + sum(c(results[[g]][[indv]][,28] == 1, results[[g]][[indv]][,55] == 1))
}
}
}
View(SAL.counter)
1:pop_size
indv
sum(results[[g]][[indv]][,13])
SAL.counter$Count.of.F.Benefit.SAL
# For each generation, count number of MALES and number of FEMALES with SAL
SAL.counter <- data.frame(
Generation = rep(1:gen_no, each = 2),
Sex = rep(c("F", "M"), times = 2*gen_no),
"Count of F-Benefit SAL" = rep(0, times = 2*gen_no),
"Count of M-Benefit SAL" = rep(0, times = 2*gen_no)
)
for(g in 1:gen_no){
for(indv in 1:pop_size){
# Record sex and SAL of each individual
if(sum(results[[g]][[indv]][,13]) == 0){
SAL.counter$Count.of.F.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "F"] <- SAL.counter$Count.of.F.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "F"] + sum(c(results[[g]][[indv]][,28] == 0, results[[g]][[indv]][,55] == 0))
SAL.counter$Count.of.M.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "F"] <- SAL.counter$Count.of.M.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "F"] + sum(c(results[[g]][[indv]][,28] == 1, results[[g]][[indv]][,55] == 1))
}else{
SAL.counter$Count.of.F.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "M"] <- SAL.counter$Count.of.F.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "M"] + sum(c(results[[g]][[indv]][,28] == 0, results[[g]][[indv]][,55] == 0))
SAL.counter$Count.of.M.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "M"] <- SAL.counter$Count.of.M.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "M"] + sum(c(results[[g]][[indv]][,28] == 1, results[[g]][[indv]][,55] == 1))
}
}
}
gen_no <- 100
num_sims <- 1
pop_size <- 1000
gen_no <- 100
s <- 0.3
chiasm <- T
fus.type <- "Y"
mu <- 10^-14
fus.large <- F
fuse.bool <- F
results <- Evolve(num_sims, pop_size, gen_no, s, chiasm, fus.type, mu, fus.large, fuse.bool)
SAL.counter$Generation[SAL.counter$Sex == "M"]
plot(SAL.counter$Count.of.M.Benefit.SAL[SAL.counter$Sex == "M"]~SAL.counter$Generation[SAL.counter$Sex == "M"])
# For each generation, count number of MALES and number of FEMALES with SAL
SAL.counter <- data.frame(
Generation = rep(1:gen_no, each = 2),
Sex = rep(c("F", "M"), times = 2*gen_no),
"Count of F-Benefit SAL" = rep(0, times = 2*gen_no),
"Count of M-Benefit SAL" = rep(0, times = 2*gen_no)
)
for(g in 1:gen_no){
for(indv in 1:pop_size){
# Record sex and SAL of each individual
if(sum(results[[g]][[indv]][,13]) == 0){
SAL.counter$Count.of.F.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "F"] <- SAL.counter$Count.of.F.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "F"] + sum(c(results[[g]][[indv]][,28] == 0, results[[g]][[indv]][,55] == 0))
SAL.counter$Count.of.M.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "F"] <- SAL.counter$Count.of.M.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "F"] + sum(c(results[[g]][[indv]][,28] == 1, results[[g]][[indv]][,55] == 1))
}else{
SAL.counter$Count.of.F.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "M"] <- SAL.counter$Count.of.F.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "M"] + sum(c(results[[g]][[indv]][,28] == 0, results[[g]][[indv]][,55] == 0))
SAL.counter$Count.of.M.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "M"] <- SAL.counter$Count.of.M.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "M"] + sum(c(results[[g]][[indv]][,28] == 1, results[[g]][[indv]][,55] == 1))
}
}
}
plot(SAL.counter$Count.of.M.Benefit.SAL[SAL.counter$Sex == "M"]~SAL.counter$Generation[SAL.counter$Sex == "M"])
plot(SAL.counter$Count.of.M.Benefit.SAL[SAL.counter$Sex == "M"]~SAL.counter$Generation[SAL.counter$Sex == "M"], pch = 16)
num_males <- (SAL.counter$Count.of.M.Benefit.SAL[SAL.counter$Sex == "M"] + SAL.counter$Count.of.F.Benefit.SAL[SAL.counter$Sex == "M"])/(4)
num_males
# For each generation, count number of MALES and number of FEMALES with SAL
SAL.counter <- data.frame(
Generation = rep(1:gen_no, each = 2),
Sex = rep(c("F", "M"), times = 2*gen_no),
"Count of F-Benefit SAL" = rep(0, times = 2*gen_no),
"Count of M-Benefit SAL" = rep(0, times = 2*gen_no),
"Number of Individuals" = rep(0, times = 2*gen_no)
)
# For each generation, count number of MALES and number of FEMALES with SAL
SAL.counter <- data.frame(
Generation = rep(1:gen_no, each = 2),
Sex = rep(c("F", "M"), times = 2*gen_no),
"Count of F-Benefit SAL" = rep(0, times = 2*gen_no),
"Count of M-Benefit SAL" = rep(0, times = 2*gen_no),
"Number of Individuals" = rep(0, times = 2*gen_no)
)
for(g in 1:gen_no){
for(indv in 1:pop_size){
# Record sex and SAL of each individual
if(sum(results[[g]][[indv]][,13]) == 0){
SAL.counter$Number.of.Individuals[SAL.counter$Generation == g & SAL.counter$Sex == "F"] <- SAL.counter$Number.of.Individuals[SAL.counter$Generation == g & SAL.counter$Sex == "F"] + 1
SAL.counter$Count.of.F.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "F"] <- SAL.counter$Count.of.F.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "F"] + sum(c(results[[g]][[indv]][,28] == 0, results[[g]][[indv]][,55] == 0))
SAL.counter$Count.of.M.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "F"] <- SAL.counter$Count.of.M.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "F"] + sum(c(results[[g]][[indv]][,28] == 1, results[[g]][[indv]][,55] == 1))
}else{
SAL.counter$Number.of.Individuals[SAL.counter$Generation == g & SAL.counter$Sex == "M"] <- SAL.counter$Number.of.Individuals[SAL.counter$Generation == g & SAL.counter$Sex == "M"] + 1
SAL.counter$Count.of.F.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "M"] <- SAL.counter$Count.of.F.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "M"] + sum(c(results[[g]][[indv]][,28] == 0, results[[g]][[indv]][,55] == 0))
SAL.counter$Count.of.M.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "M"] <- SAL.counter$Count.of.M.Benefit.SAL[SAL.counter$Generation == g & SAL.counter$Sex == "M"] + sum(c(results[[g]][[indv]][,28] == 1, results[[g]][[indv]][,55] == 1))
}
}
}
SAL.counter$Frequency_F_Benefit <- SAL.counter$Count.of.F.Benefit.SAL/SAL.counter$Number.of.Individuals
SAL.counter$Frequency_M_Benefit <- SAL.counter$Count.of.M.Benefit.SAL/SAL.counter$Number.of.Individuals
plot(SAL.counter$Frequency_M_Benefit[SAL.counter$Sex == "M"]~SAL.counter$Generation[SAL.counter$Sex == "M"], pch = 16)
SAL.counter$Frequency_F_Benefit <- SAL.counter$Count.of.F.Benefit.SAL/(SAL.counter$Number.of.Individuals * 4)
SAL.counter$Frequency_M_Benefit <- SAL.counter$Count.of.M.Benefit.SAL/(SAL.counter$Number.of.Individuals * 4)
plot(SAL.counter$Frequency_M_Benefit[SAL.counter$Sex == "M"]~SAL.counter$Generation[SAL.counter$Sex == "M"], pch = 16)
plot(SAL.counter$Frequency_M_Benefit[SAL.counter$Sex == "M"]~SAL.counter$Generation[SAL.counter$Sex == "M"], pch = 16, yaxt = "Frequency of Male-Benefit Alleles in Males", xaxt = "Generation")
?plot
plot(SAL.counter$Frequency_M_Benefit[SAL.counter$Sex == "M"]~SAL.counter$Generation[SAL.counter$Sex == "M"],
ylab = "Frequency of Male-Benefit Alleles in Males", xlab = "Generation",
pch = 16, main = "No Fusions")
plot(SAL.counter$Frequency_M_Benefit[SAL.counter$Sex == "M"]~SAL.counter$Generation[SAL.counter$Sex == "M"],
ylab = "Frequency of Male-Benefit Alleles in Males", xlab = "Generation",
pch = 16, main = "1 Simulation with No Fusions")
# Check proportion of heterozygotes of each sex at final generation
num_HetF <- 0
num_HetM <- 0
num_F <- 0
num_M <- 0
for(indv in 1:pop_size){
if(sum(results[[g]][[indv]][,13]) == 0){
num_F <- num_F + 1
count_in_F <- sum(c(results[[1000]][[indv]][,28] == 0, results[[1000]][[indv]][,55] == 0))
if(count_in_F == 2){
num_HetF <- num_HetF + 1
}
}else{
num_M <- num_M + 1
count_in_M <- sum(c(results[[1000]][[indv]][,28] == 0, results[[1000]][[indv]][,55] == 0))
if(count_in_M == 2){
num_HetM <- num_HetM + 1
}
}
}
for(indv in 1:pop_size){
if(sum(results[[g]][[indv]][,13]) == 0){
num_F <- num_F + 1
count_in_F <- sum(c(results[[100]][[indv]][,28] == 0, results[[100]][[indv]][,55] == 0))
if(count_in_F == 2){
num_HetF <- num_HetF + 1
}
}else{
num_M <- num_M + 1
count_in_M <- sum(c(results[[100]][[indv]][,28] == 0, results[[100]][[indv]][,55] == 0))
if(count_in_M == 2){
num_HetM <- num_HetM + 1
}
}
}
prop_HetF <- num_HetF/num_F
prop_HetF
prop_HetM <- num_HetM/num_M
prop_HetM
gen_no <- 99
# Check proportion of heterozygotes of each sex at final generation
num_HetF <- 0
num_HetM <- 0
num_F <- 0
num_M <- 0
for(indv in 1:pop_size){
if(sum(results[[g]][[indv]][,13]) == 0){
num_F <- num_F + 1
count_in_F <- sum(c(results[[gen_no]][[indv]][,28] == 0, results[[gen_no]][[indv]][,55] == 0))
if(count_in_F == 2){
num_HetF <- num_HetF + 1
}
}else{
num_M <- num_M + 1
count_in_M <- sum(c(results[[gen_no]][[indv]][,28] == 0, results[[gen_no]][[indv]][,55] == 0))
if(count_in_M == 2){
num_HetM <- num_HetM + 1
}
}
}
prop_HetF <- num_HetF/num_F
prop_HetM <- num_HetM/num_M
prop_HetF
prop_HetM
gen_no <- 1
# Check proportion of heterozygotes of each sex at final generation
num_HetF <- 0
num_HetM <- 0
num_F <- 0
num_M <- 0
for(indv in 1:pop_size){
if(sum(results[[g]][[indv]][,13]) == 0){
num_F <- num_F + 1
count_in_F <- sum(c(results[[gen_no]][[indv]][,28] == 0, results[[gen_no]][[indv]][,55] == 0))
if(count_in_F == 2){
num_HetF <- num_HetF + 1
}
}else{
num_M <- num_M + 1
count_in_M <- sum(c(results[[gen_no]][[indv]][,28] == 0, results[[gen_no]][[indv]][,55] == 0))
if(count_in_M == 2){
num_HetM <- num_HetM + 1
}
}
}
prop_HetF <- num_HetF/num_F
prop_HetM <- num_HetM/num_M
prop_HetF
prop_HetM
prop_HetF <- vector(mode = "numeric", length = gen_no)
prop_HetM <- vector(mode = "numeric", length = gen_no)
prop_HetF
gen_no
gen_no <- 1000
gen_no <- 100
prop_HetF <- vector(mode = "numeric", length = gen_no)
prop_HetM <- vector(mode = "numeric", length = gen_no)
for(gen in 1:gen_no){
for(indv in 1:pop_size){
if(sum(results[[g]][[indv]][,13]) == 0){
num_F <- num_F + 1
count_in_F <- sum(c(results[[gen]][[indv]][,28] == 0, results[[gen]][[indv]][,55] == 0))
if(count_in_F == 2){
num_HetF <- num_HetF + 1
}
}else{
num_M <- num_M + 1
count_in_M <- sum(c(results[[gen]][[indv]][,28] == 0, results[[gen]][[indv]][,55] == 0))
if(count_in_M == 2){
num_HetM <- num_HetM + 1
}
}
}
prop_HetF[gen] <- num_HetF/num_F
prop_HetM[gen] <- num_HetM/num_M
}
plot(propHetF~1:gen_no)
prop_HetF
plot(propHetF~1:gen_no)
propHetF
plot(prop_HetF~1:gen_no)
prop_HetF
gen_no
1:gen_no
prop_HetF
plot(prop_HetF~1:gen_no)
plot(prop_HetF~(1:gen_no))
gen_no
plot(prop_HetF~(1:100))
prop_HetF
plot(y = prop_HetF, x = (1:100))
# Check genotypic frequencies of each sexually-antagonistic locus over time
# 0 = Homozygous for FEMALE-BENEFIT allele
# 1 = Heterozygous
# 2 = Homozygous for MALE-BENEFIT allele
genotypic_frequencies <- data.frame(
Generation <- rep(1:gen_no, each = pop_size),
Individual <- rep(1:pop_size, times = gen_no),
Sex <- rep(0, times = gen_no*pop_size),
Small_SAL <- rep(0, times = gen_no*pop_size),
Large_SAL <- rep(0, times = gen_no*pop_size)
)
indv
gen
results[[gen]][[indv]][,28]
# Check genotypic frequencies of each sexually-antagonistic locus over time
# 0 = Homozygous for FEMALE-BENEFIT allele
# 1 = Heterozygous
# 2 = Homozygous for MALE-BENEFIT allele
genotypic_frequencies <- data.frame(
Generation = rep(1:gen_no, each = pop_size),
Individual = rep(1:pop_size, times = gen_no),
Sex = rep(0, times = gen_no*pop_size),
Small_SAL = rep(0, times = gen_no*pop_size),
Large_SAL = rep(0, times = gen_no*pop_size)
)
genotypic_frequencies
# Check genotypic frequencies of each sexually-antagonistic locus over time
# 0 = Homozygous for FEMALE-BENEFIT allele
# 1 = Heterozygous
# 2 = Homozygous for MALE-BENEFIT allele
genotypic_frequencies <- data.frame(
Generation = rep(1:gen_no, each = pop_size),
Individual = rep(1:pop_size, times = gen_no),
Sex = rep(0, times = gen_no*pop_size),
Small_SAL = rep(0, times = gen_no*pop_size),
Large_SAL = rep(0, times = gen_no*pop_size)
)
genotypic_frequencies
# Record sex and genotype of each individual
for(gen in 1:gen_no){
for(indv in 1:pop_size){
genotypic_frequencies$Small_SAL[genotypic_frequencies$Generation == gen & genotypic_frequencies$Individual == indv] <- sum(results[[gen]][[indv]][,28])
genotypic_frequencies$Large_SAL[genotypic_frequencies$Generation == gen & genotypic_frequencies$Individual == indv] <- sum(results[[gen]][[indv]][,55])
if(sum(results[[g]][[indv]][,13]) == 0){
genotypic_frequencies$Sex[genotypic_frequencies$Generation == gen & genotypic_frequencies$Individual == indv] <- "F"
}else{
genotypic_frequencies$Sex[genotypic_frequencies$Generation == gen & genotypic_frequencies$Individual == indv] <- "M"
}
}
}
# Check genotypic frequencies of each sexually-antagonistic locus over time
# 0 = Homozygous for FEMALE-BENEFIT allele
# 1 = Heterozygous
# 2 = Homozygous for MALE-BENEFIT allele
genotypic_frequencies <- data.frame(
Generation = rep(1:gen_no, each = pop_size),
Individual = rep(1:pop_size, times = gen_no),
Sex = rep(0, times = gen_no*pop_size),
Small_SAL = rep(0, times = gen_no*pop_size),
Large_SAL = rep(0, times = gen_no*pop_size)
)
# Record sex and genotype of each individual
for(gen in 1:gen_no){
print(gen)
for(indv in 1:pop_size){
genotypic_frequencies$Small_SAL[genotypic_frequencies$Generation == gen & genotypic_frequencies$Individual == indv] <- sum(results[[gen]][[indv]][,28])
genotypic_frequencies$Large_SAL[genotypic_frequencies$Generation == gen & genotypic_frequencies$Individual == indv] <- sum(results[[gen]][[indv]][,55])
if(sum(results[[g]][[indv]][,13]) == 0){
genotypic_frequencies$Sex[genotypic_frequencies$Generation == gen & genotypic_frequencies$Individual == indv] <- "F"
}else{
genotypic_frequencies$Sex[genotypic_frequencies$Generation == gen & genotypic_frequencies$Individual == indv] <- "M"
}
}
}
genotypic_frequencies$Small_SAL[genotypic_frequencies$Sex == "M"]
# Genotypic distribution of small autosome SAL at generation 0
plot(density(genotypic_frequencies$Small_SAL[genotypic_frequencies$Sex == "M" &
genotypic_frequencies$Generation == 1]))
# Genotypic distribution of small autosome SAL at generation 0
plot(density(genotypic_frequencies$Small_SAL[genotypic_frequencies$Sex == "M" &
genotypic_frequencies$Generation == 1]),
main = "Distribution of Genotypes of Small Autosome in Males (First Generation)")
?density
# Genotypic distribution of small autosome SAL at generation 0
plot(density(genotypic_frequencies$Small_SAL[genotypic_frequencies$Sex == "M" &
genotypic_frequencies$Generation == 1]),
main = "Distribution of Genotypes of Small Autosome in Males (First Generation)")
# Genotypic distribution of small autosome SAL in males at final generation
plot(density(genotypic_frequencies$Small_SAL[genotypic_frequencies$Sex == "M" &
genotypic_frequencies$Generation == gen_no]),
main = "Distribution of Genotypes of Small Autosome in Males (Final Generation)")
# Check genotypic frequencies of each sexually-antagonistic locus over time
# 0 = Homozygous for FEMALE-BENEFIT allele
# 1 = Heterozygous
# 2 = Homozygous for MALE-BENEFIT allele
genotypes <- data.frame(
Generation = rep(1:gen_no, each = pop_size),
Individual = rep(1:pop_size, times = gen_no),
Sex = rep(0, times = gen_no*pop_size),
Small_SAL = rep(0, times = gen_no*pop_size),
Large_SAL = rep(0, times = gen_no*pop_size)
)
# Frequency of each genotype over time
genotypic_frequencies <- data.frame(matrix(ncol = 7, nrow = gen_no)
)
# Frequency of each genotype over time
genotypic_frequencies <- data.frame(matrix(ncol = 4, nrow = gen_no))
colnames(genotypic_frequencies) <- c("Generation","Autosome","Genotype","Frequency")
# Frequency of each genotype over time
genotypic_frequencies <- data.frame(matrix(ncol = 4, nrow = gen_no*2*3))
colnames(genotypic_frequencies) <- c("Generation","Autosome","Genotype","Frequency")
# Frequency of each genotype over time
genotypic_frequencies <- data.frame(
Generation = rep(1:gen_no, each = 6),
Autosome = rep(c("Small", "Large"), times = gen_no, each = 3),
Genotype = rep(c("F-Benefit Homo", "Hetero", "M-Benefit Homo"), times = gen_no*2),
Frequency = rep(0, times = gen_no*6))
genotypic_frequencies
genotypes
# Record sex and genotype of each individual
for(gen in 1:gen_no){
print(gen)
for(indv in 1:pop_size){
genotypes$Small_SAL[genotypes$Generation == gen & genotypes$Individual == indv] <- sum(results[[gen]][[indv]][,28])
genotypes$Large_SAL[genotypes$Generation == gen & genotypes$Individual == indv] <- sum(results[[gen]][[indv]][,55])
if(sum(results[[g]][[indv]][,13]) == 0){
genotypes$Sex[genotypes$Generation == gen & genotypes$Individual == indv] <- "F"
}else{
genotypes$Sex[genotypes$Generation == gen & genotypes$Individual == indv] <- "M"
}
}
}
# Frequency of each genotype over time
genotypic_frequencies <- data.frame(
Generation = rep(1:gen_no, each = 6),
Autosome = rep(c("Small", "Large"), times = gen_no, each = 3),
Genotype = rep(c("F-Benefit Homo", "Hetero", "M-Benefit Homo"), times = gen_no*2),
Frequency = rep(0, times = gen_no*6)
)
for(gen in 1:gen_no){
genotypic_frequencies$Frequency[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Small" & genotypic_frequencies$Genotype == "F-Benefit Homo"] <- sum(genotypes$Small_SAL[genotypes$Generation == gen] == 0)/pop_size
genotypic_frequencies$Frequency[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Small" & genotypic_frequencies$Genotype == "Hetero"] <- sum(genotypes$Small_SAL[genotypes$Generation == gen] == 1)/pop_size
genotypic_frequencies$Frequency[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Small" & genotypic_frequencies$Genotype == "M-Benefit Homo"] <- sum(genotypes$Small_SAL[genotypes$Generation == gen] == 2)/pop_size
genotypic_frequencies$Frequency[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Large" & genotypic_frequencies$Genotype == "F-Benefit Homo"] <- sum(genotypes$Large_SAL[genotypes$Generation == gen] == 0)/pop_size
genotypic_frequencies$Frequency[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Large" & genotypic_frequencies$Genotype == "Hetero"] <- sum(genotypes$Large_SAL[genotypes$Generation == gen] == 1)/pop_size
genotypic_frequencies$Frequency[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Large" & genotypic_frequencies$Genotype == "M-Benefit Homo"] <- sum(genotypes$Large_SAL[genotypes$Generation == gen] == 2)/pop_size
}
View(genotypic_frequencies)
library(ggplot2)
library(viridis)
install.packages(viridis)
install.packages("viridis")
library(viridis)
col.vec <- viridis(6)
ggplot(data = genotypic_frequencies, aes(x = Generation, y = Frequency,
color = Genotype)) +
geom_line()
ggplot(data = genotypic_frequencies, aes(x = Generation, y = Frequency,
color = Genotype)) +
geom_line() +
geom_title(paste(c("Chiasmatic, no fusions. Population Size = ", pop_size, " mu = ", mu, " s = ", s), collapse = ""))
ggplot(data = genotypic_frequencies, aes(x = Generation, y = Frequency,
color = Genotype)) +
geom_line() +
ggtitle(paste(c("Chiasmatic, no fusions. Population Size = ", pop_size, " mu = ", mu, " s = ", s), collapse = ""))
# Find frequency of each genotype in each generation
genotypic_frequencies <- data.frame(
Generation = rep(1:gen_no, each = 6),
Autosome = rep(c("Small", "Large"), times = gen_no, each = 3),
Genotype = rep(c("F-Benefit Homo", "Hetero", "M-Benefit Homo"), times = gen_no*2),
Frequency = rep(0, times = gen_no*6),
"Frequency in Males" = rep(0, times = gen_no*6),
"Frequency in Females" = rep(0, times = gen_no*6),
)
# Find frequency of each genotype in each generation
genotypic_frequencies <- data.frame(
Generation = rep(1:gen_no, each = 6),
Autosome = rep(c("Small", "Large"), times = gen_no, each = 3),
Genotype = rep(c("F-Benefit Homo", "Hetero", "M-Benefit Homo"), times = gen_no*2),
Frequency = rep(0, times = gen_no*6),
"Frequency in Males" = rep(0, times = gen_no*6),
"Frequency in Females" = rep(0, times = gen_no*6)
)
for(gen in 1:gen_no){
genotypic_frequencies$Frequency[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Small" & genotypic_frequencies$Genotype == "F-Benefit Homo"] <- sum(genotypes$Small_SAL[genotypes$Generation == gen] == 0)/pop_size
genotypic_frequencies$Frequency[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Small" & genotypic_frequencies$Genotype == "Hetero"] <- sum(genotypes$Small_SAL[genotypes$Generation == gen] == 1)/pop_size
genotypic_frequencies$Frequency[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Small" & genotypic_frequencies$Genotype == "M-Benefit Homo"] <- sum(genotypes$Small_SAL[genotypes$Generation == gen] == 2)/pop_size
genotypic_frequencies$Frequency[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Large" & genotypic_frequencies$Genotype == "F-Benefit Homo"] <- sum(genotypes$Large_SAL[genotypes$Generation == gen] == 0)/pop_size
genotypic_frequencies$Frequency[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Large" & genotypic_frequencies$Genotype == "Hetero"] <- sum(genotypes$Large_SAL[genotypes$Generation == gen] == 1)/pop_size
genotypic_frequencies$Frequency[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Large" & genotypic_frequencies$Genotype == "M-Benefit Homo"] <- sum(genotypes$Large_SAL[genotypes$Generation == gen] == 2)/pop_size
num_males <- sum(genotypes$Sex[genotypes$Generation == gen] == "M")
genotypic_frequencies$Frequency.in.Males[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Small" & genotypic_frequencies$Genotype == "F-Benefit Homo"] <- sum(genotypes$Small_SAL[genotypes$Generation == gen] == 0)/num_males
genotypic_frequencies$Frequency.in.Males[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Small" & genotypic_frequencies$Genotype == "Hetero"] <- sum(genotypes$Small_SAL[genotypes$Generation == gen] == 1)/num_males
genotypic_frequencies$Frequency.in.Males[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Small" & genotypic_frequencies$Genotype == "M-Benefit Homo"] <- sum(genotypes$Small_SAL[genotypes$Generation == gen] == 2)/num_males
genotypic_frequencies$Frequency.in.Males[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Large" & genotypic_frequencies$Genotype == "F-Benefit Homo"] <- sum(genotypes$Large_SAL[genotypes$Generation == gen] == 0)/num_males
genotypic_frequencies$Frequency.in.Males[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Large" & genotypic_frequencies$Genotype == "Hetero"] <- sum(genotypes$Large_SAL[genotypes$Generation == gen] == 1)/num_males
genotypic_frequencies$Frequency.in.Males[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Large" & genotypic_frequencies$Genotype == "M-Benefit Homo"] <- sum(genotypes$Large_SAL[genotypes$Generation == gen] == 2)/num_males
num_females <- sum(genotypes$Sex[genotypes$Generation == gen] == "F")
genotypic_frequencies$Frequency.in.Females[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Small" & genotypic_frequencies$Genotype == "F-Benefit Homo"] <- sum(genotypes$Small_SAL[genotypes$Generation == gen] == 0)/num_females
genotypic_frequencies$Frequency.in.Females[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Small" & genotypic_frequencies$Genotype == "Hetero"] <- sum(genotypes$Small_SAL[genotypes$Generation == gen] == 1)/num_females
genotypic_frequencies$Frequency.in.Females[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Small" & genotypic_frequencies$Genotype == "M-Benefit Homo"] <- sum(genotypes$Small_SAL[genotypes$Generation == gen] == 2)/num_females
genotypic_frequencies$Frequency.in.Females[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Large" & genotypic_frequencies$Genotype == "F-Benefit Homo"] <- sum(genotypes$Large_SAL[genotypes$Generation == gen] == 0)/num_females
genotypic_frequencies$Frequency.in.Females[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Large" & genotypic_frequencies$Genotype == "Hetero"] <- sum(genotypes$Large_SAL[genotypes$Generation == gen] == 1)/num_females
genotypic_frequencies$Frequency.in.Females[genotypic_frequencies$Generation == gen & genotypic_frequencies$Autosome == "Large" & genotypic_frequencies$Genotype == "M-Benefit Homo"] <- sum(genotypes$Large_SAL[genotypes$Generation == gen] == 2)/num_females
}
# Plot frequency of each genotype over time
small_frequencies <- genotypic_frequencies[genotypic_frequencies$Autosome == "Small",]
ggplot(data = small_frequencies, aes(x = Generation, y = Frequency,
color = Genotype)) +
geom_line() +
ggtitle(paste(c("Chiasmatic, no fusions. Population Size = ", pop_size, " mu = ", mu, " s = ", s), collapse = ""))
# Plot frequency of each genotype over time
small_frequencies <- genotypic_frequencies[genotypic_frequencies$Autosome == "Small",]
ggplot(data = small_frequencies, aes(x = Generation, y = Frequency,
color = Genotype)) +
geom_line() +
legend("Genotype of Small Autosome SAL") +
ggtitle(paste(c("Chiasmatic, no fusions. Population Size = ", pop_size, " mu = ", mu, " s = ", s), collapse = ""))
ggplot(data = small_frequencies, aes(x = Generation, y = Frequency,
color = Genotype)) +
geom_line() +
scale_fill_discrete(name = "Genotype of Small Autosome SAL") +
ggtitle(paste(c("Chiasmatic, no fusions. Population Size = ", pop_size, " mu = ", mu, " s = ", s), collapse = ""))
ggplot(data = small_frequencies, aes(x = Generation, y = Frequency,
color = Genotype)) +
geom_line() +
guides(fill=guide_legend("Genotype of Small Autosome SAL"))+
ggtitle(paste(c("Chiasmatic, no fusions. Population Size = ", pop_size, " mu = ", mu, " s = ", s), collapse = ""))
ggplot() +
geom_line(data = small_frequencies, aes(x = Generation, y = Frequency,
color = Genotype)) +
guides(fill=guide_legend("Genotype of Small Autosome SAL"))+
ggtitle(paste(c("Chiasmatic, no fusions. Population Size = ", pop_size, " mu = ", mu, " s = ", s), collapse = ""))
names(small_frequencies)
names(small_frequencies)[3] <- "Genotype of Small Autosome SAL"
ggplot() +
geom_line(data = small_frequencies, aes(x = Generation, y = Frequency,
color = Genotype)) +
ggtitle(paste(c("Chiasmatic, no fusions. Population Size = ", pop_size, " mu = ", mu, " s = ", s), collapse = ""))
ggplot() +
geom_line(data = small_frequencies, aes(x = Generation, y = Frequency,
color = `Genotype of Small Autosome SAL`)) +
ggtitle(paste(c("Chiasmatic, no fusions. Population Size = ", pop_size, " mu = ", mu, " s = ", s), collapse = ""))
large_frequencies <- genotypic_frequencies[genotypic_frequencies$Autosome == "Large",]
names(large_frequencies)[3] <- "Genotype of Large Autosome SAL"
ggplot() +
geom_line(data = large_frequencies, aes(x = Generation, y = Frequency,
color = `Genotype of Large Autosome SAL`)) +
ggtitle(paste(c("Chiasmatic, no fusions. Population Size = ", pop_size, " mu = ", mu, " s = ", s), collapse = ""))
