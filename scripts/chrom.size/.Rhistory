}
(1:100)[-c(13,36,61)]
pop <- ActofGod(x, dfe)
pop
# 3 pick parents
GetParents <- function(pop, fits, N){
sexes <- rep("fem",length(pop))
for(i in 1:N){
if(pop[[i]][2,13]){
sexes[i] <- "mal"
}
}
moms <- sample((1:N)[sexes=="fem"], prob=fits[sexes=="fem"],
size=length(pop)/2, replace = T)
dads <- sample((1:N)[sexes=="mal"], prob=fits[sexes=="mal"],
size=length(pop)/2, replace = T)
return(list(moms,dads))
}
parents <- GetParents(pop, fit, 50)
# 3 pick parents
GetParents <- function(pop, fits, N = length(pop)){
sexes <- rep("fem",length(pop))
for(i in 1:N){
if(pop[[i]][2,13]){
sexes[i] <- "mal"
}
}
moms <- sample((1:N)[sexes=="fem"], prob=fits[sexes=="fem"],
size=length(pop)/2, replace = T)
dads <- sample((1:N)[sexes=="mal"], prob=fits[sexes=="mal"],
size=length(pop)/2, replace = T)
return(list(moms,dads))
}
gametes <- vector(mode="list",length=2)
names(gametes) <- c("eggs","sperm")
View(parents)
parents[[1]]
# 3 pick parents
GetParents <- function(pop, fits, N = length(pop)){
sexes <- rep("fem",length(pop))
for(i in 1:N){
if(pop[[i]][2,13]){
sexes[i] <- "mal"
}
}
moms <- sample((1:N)[sexes=="fem"], prob=fits[sexes=="fem"],
size=length(pop)/2, replace = T)
dads <- sample((1:N)[sexes=="mal"], prob=fits[sexes=="mal"],
size=length(pop)/2, replace = T)
parents <- list(moms,dads)
names(parents) <- c("Moms","Dads")
return(parents)
}
parents <- GetParents(pop, fit, 50)
parents
parents$Dads[i]
i=1
parents$Dads[i]
pop[[parents$Dads[i]]]
(PARb+1):24
PARb = 1
(PARb+1):24
sample((PARb+1):24, 1)
sample((PARb+1):24, 1)
sample((PARb+1):24, 1)
sample((PARb+1):24, 1)
sample((PARb+1):24, 1)
sample((PARb+1):24, 1)
sample((PARb+1):24, 1)
sample((PARb+1):24, 1)
sample((PARb+1):24, 1)
sample((PARb+1):24, 1)
sample((PARb+1):24, 1)
sample((PARb+1):24, 1)
sample((PARb+1):24, 1)
sample((PARb+1):24, 1)
sample((PARb+1):24, 1)
sample((PARb+1):24, 1)
sample((PARb+1):24, 1)
sample((PARb+1):24, 1)
sample((PARb+1):24, 1)
sample(27:49, 1)
parents
i
pops[parents$Dads[i]]
pop[parents$Dads[i]]
pop[[parents$Dads[i]]]
# Pick 3 random sites OTHER than 13, 36, and 61 in...
# PAR ((PARb+1):24)
# Autosome I (27:49)
# Autosome II (52-99)
# ... at which recombination occurs (recombination CANNOT occur at first or
# final locus of a chromosome, so these loci are excluded)
SexRec <- sample((PARb+1):24, 1)
SexRec
1:SexRec
pop[[parents$Dads[i]]][1:SexRec,2]
x <- `:3`
x <- 1:3
x
x <- matrix(1:6, nrow = 2)
x
x[1:2, 2]
x[2, 1:2]
paste(pop[[parents$Dads[i]]][2,1:SexRec]
)
?paste
paste(pop[[parents$Dads[i]]][2,1:SexRec], collapse = "")
SexRec
c(pop[[parents$Dads[i]]][2,1:SexRec],
pop[[parents$Dads[i]]][1,SexRec:25])
paste(c(pop[[parents$Dads[i]]][2,1:SexRec],
pop[[parents$Dads[i]]][1,SexRec:25]), collapse = "")
paste(c(pop[[parents$Dads[i]]][1,1:(SexRec+1)],
pop[[parents$Dads[i]]][2,SexRec:25]), collapse = "")
x <- 1:25
y <- rep(A, 25)
y <- rep("A", 25)
y
y[10] <- B
y[10] <- "B"
y
x <- rep("C",25)
x[9] <- "D"
x
SexRec=10
paste(c(x[1:(SexRec-1)],
y[SexRec:25]), collapse = "")
y <- rep("A", 25)
y[10] <- "B"
x <- rep("C",25)
x[9] <- "D"
y
paste(c(y[1:(SexRec+1)],
x[SexRec:25]), collapse = "")
paste(c(y[1:(SexRec)],
x[(SexRec-1):25]), collapse = "")
paste(c(y[1:(SexRec-1)],
x[SexRec:25]), collapse = "")
paste(c(x[1:(SexRec-1)],
y[SexRec:25]), collapse = "")
y
x
# For each chromosome, create two recombinant gametes and add to vectors
# to later be sampled from
SexChrGametes <- c(
paste(c(pop[[parents$Dads[i]]][2,1:(SexRec-1)],
pop[[parents$Dads[i]]][1,SexRec:25]), collapse = ""),
paste(c(pop[[parents$Dads[i]]][1,1:(SexRec-1)],
pop[[parents$Dads[i]]][2,SexRec:25]), collapse = "")
)
SexChrGametes
sample(SexChrGametes, 1)
paste(c(sample(SexChrGametes, 1),
sample(Chr1Gametes, 1),
sample(Chr2Gametes, 1)), collapse = "")
Chr1Gametes <- c(
paste(c(pop[[parents$Dads[i]]][2,26:(Chr1Rec-1)],
pop[[parents$Dads[i]]][1,Chr1Rec:50]), collapse = ""),
paste(c(pop[[parents$Dads[i]]][1,26:(Chr1Rec-1)],
pop[[parents$Dads[i]]][2,Chr1Rec:50]), collapse = "")
)
Chr2Gametes <- c(
paste(c(pop[[parents$Dads[i]]][2,51:(Chr2Rec-1)],
pop[[parents$Dads[i]]][1,Chr2Rec:100]), collapse = ""),
paste(c(pop[[parents$Dads[i]]][1,51:(Chr2Rec-1)],
pop[[parents$Dads[i]]][2,Chr2Rec:100]), collapse = "")
)
# Pick 3 random sites OTHER than 13, 36, and 61 in...
# PAR ((PARb+1):24)
# Autosome I (27:49)
# Autosome II (52-99)
# ... at which recombination occurs (recombination CANNOT occur at first or
# final locus of a chromosome, so these loci are excluded)
SexRec <- sample((PARb+1):24, 1)
Chr1Rec <- sample(27:49, 1)
Chr2Rec <- sample(52:99, 1)
# For each chromosome, create two recombinant homologs and add to vectors
# from which gametes will be selected
SexChrGametes <- c(
paste(c(pop[[parents$Dads[i]]][2,1:(SexRec-1)],
pop[[parents$Dads[i]]][1,SexRec:25]), collapse = ""),
paste(c(pop[[parents$Dads[i]]][1,1:(SexRec-1)],
pop[[parents$Dads[i]]][2,SexRec:25]), collapse = "")
)
Chr1Gametes <- c(
paste(c(pop[[parents$Dads[i]]][2,26:(Chr1Rec-1)],
pop[[parents$Dads[i]]][1,Chr1Rec:50]), collapse = ""),
paste(c(pop[[parents$Dads[i]]][1,26:(Chr1Rec-1)],
pop[[parents$Dads[i]]][2,Chr1Rec:50]), collapse = "")
)
Chr2Gametes <- c(
paste(c(pop[[parents$Dads[i]]][2,51:(Chr2Rec-1)],
pop[[parents$Dads[i]]][1,Chr2Rec:100]), collapse = ""),
paste(c(pop[[parents$Dads[i]]][1,51:(Chr2Rec-1)],
pop[[parents$Dads[i]]][2,Chr2Rec:100]), collapse = "")
)
# For each chromosome, randomly select ONE homolog from the two
# recombinant homologs and stick the 3 chromosomes together to create a
# haploid genome, adding this genome to the list of gametes under "sperm"
gametes$sperm[i] <- paste(c(sample(SexChrGametes, 1),
sample(Chr1Gametes, 1),
sample(Chr2Gametes, 1)), collapse = "")
gametes$sperm[i]
length(gametes$sperm[i])
pop
# 4 make gametes
# pop = list of genomes
# parent = list of two sets of integers describing the individuals who get to
# breed
# PARb = Starting locus of pseudoautosomal region of the male sex chromosomes
# Output (gametes) = list of two sets of vectors each describing the sequence
# of a haploid gamete
MakeGametes <- function(pop, parents, PARb){
gametes <- vector(mode="list",length=2)
names(gametes) <- c("eggs","sperm")
# Iterate through each parent
for(i in 1:length(parents)){
# For male...
# Check whether individual is chiasmatic or not
# TODO: Change this portion of code so individual is NOT always set as
# chiasmatic
chiasm <- T
# If individual is chiasmatic...
if(chiasm){
# Pick 3 random sites OTHER than 13, 36, and 61 in...
# PAR ((PARb+1):24)
# Autosome I (27:49)
# Autosome II (52-99)
# ... at which recombination occurs (recombination CANNOT occur at first or
# final locus of a chromosome, so these loci are excluded)
SexRec <- sample((PARb+1):24, 1)
Chr1Rec <- sample(27:49, 1)
Chr2Rec <- sample(52:99, 1)
# For each chromosome, create two recombinant homologs and add to vectors
# from which gametes will be selected
SexChrGametes <- c(
paste(c(pop[[parents$Dads[i]]][2,1:(SexRec-1)],
pop[[parents$Dads[i]]][1,SexRec:25]), collapse = ""),
paste(c(pop[[parents$Dads[i]]][1,1:(SexRec-1)],
pop[[parents$Dads[i]]][2,SexRec:25]), collapse = "")
)
Chr1Gametes <- c(
paste(c(pop[[parents$Dads[i]]][2,26:(Chr1Rec-1)],
pop[[parents$Dads[i]]][1,Chr1Rec:50]), collapse = ""),
paste(c(pop[[parents$Dads[i]]][1,26:(Chr1Rec-1)],
pop[[parents$Dads[i]]][2,Chr1Rec:50]), collapse = "")
)
Chr2Gametes <- c(
paste(c(pop[[parents$Dads[i]]][2,51:(Chr2Rec-1)],
pop[[parents$Dads[i]]][1,Chr2Rec:100]), collapse = ""),
paste(c(pop[[parents$Dads[i]]][1,51:(Chr2Rec-1)],
pop[[parents$Dads[i]]][2,Chr2Rec:100]), collapse = "")
)
# For each chromosome, randomly select ONE homolog from the two
# recombinant homologs and stick the 3 chromosomes together to create a
# haploid genome, adding this genome to the list of gametes under "sperm"
gametes$sperm[i] <- paste(c(sample(SexChrGametes, 1),
sample(Chr1Gametes, 1),
sample(Chr2Gametes, 1)), collapse = "")
}
# For female..
# Pick 3 random sites OTHER than 13, 36, and 61 in...
# Sex chromosome (2:24)
# Autosome I (27:49)
# Autosome II (52-99)
# ... at which recombination occurs (recombination CANNOT occur at first or
# final locus of a chromosome, so these loci are excluded)
SexRec <- sample(2:24, 1)
Chr1Rec <- sample(27:49, 1)
Chr2Rec <- sample(52:99, 1)
# For each chromosome, create two recombinant homologs and add to vectors
# from which gametes will be selected
SexChrGametes <- c(
paste(c(pop[[parents$Moms[i]]][2,1:(SexRec-1)],
pop[[parents$Moms[i]]][1,SexRec:25]), collapse = ""),
paste(c(pop[[parents$Moms[i]]][1,1:(SexRec-1)],
pop[[parents$Moms[i]]][2,SexRec:25]), collapse = "")
)
Chr1Gametes <- c(
paste(c(pop[[parents$Moms[i]]][2,26:(Chr1Rec-1)],
pop[[parents$Moms[i]]][1,Chr1Rec:50]), collapse = ""),
paste(c(pop[[parents$Moms[i]]][1,26:(Chr1Rec-1)],
pop[[parents$Moms[i]]][2,Chr1Rec:50]), collapse = "")
)
Chr2Gametes <- c(
paste(c(pop[[parents$Moms[i]]][2,51:(Chr2Rec-1)],
pop[[parents$Moms[i]]][1,Chr2Rec:100]), collapse = ""),
paste(c(pop[[parents$Moms[i]]][1,51:(Chr2Rec-1)],
pop[[parents$Moms[i]]][2,Chr2Rec:100]), collapse = "")
)
# For each chromosome, randomly select one homolog from the two
# recombinant homologs and stick these chromosomes together to create a
# haploid genome, adding this genome to the list of gametes under "eggs"
gametes$eggs[i] <- paste(c(sample(SexChrGametes, 1),
sample(Chr1Gametes, 1),
sample(Chr2Gametes, 1)), collapse = "")
}
# Return list of eggs and sperm
return(gametes)
}
pop
pop <- vector(mode = "list", length = 2)
pop[[1]] <- matrix(1:200, nrow = 2, byrow = T)
pop[[1]]
pop[[2]] <- matrix(201:400, nrow = 2, byrow = T)
PARb = 15
parents
parents <- vector(mode = "list", length = 2)
names(parents) <- c("Moms","Dads")
parents
parents$Moms <- 1
parents$Dads <- 2
parents
# 4 make gametes
# pop = list of genomes
# parent = list of two sets of integers describing the individuals who get to
# breed
# PARb = Starting locus of pseudoautosomal region of the male sex chromosomes
# Output (gametes) = list of two sets of vectors each describing the sequence
# of a haploid gamete
MakeGametes <- function(pop, parents, PARb){
gametes <- vector(mode="list",length=2)
names(gametes) <- c("eggs","sperm")
# Iterate through each parent
for(i in 1:length(parents)){
# For male...
# Check whether individual is chiasmatic or not
# TODO: Change this portion of code so individual is NOT always set as
# chiasmatic
chiasm <- T
# If individual is chiasmatic...
if(chiasm){
# Pick 3 random sites OTHER than 13, 36, and 61 in...
# PAR ((PARb+1):24)
# Autosome I (27:49)
# Autosome II (52-99)
# ... at which recombination occurs (recombination CANNOT occur at first or
# final locus of a chromosome, so these loci are excluded)
SexRec <- sample((PARb+1):24, 1)
Chr1Rec <- sample(27:49, 1)
Chr2Rec <- sample(52:99, 1)
# For each chromosome, create two recombinant homologs and add to vectors
# from which gametes will be selected
SexChrGametes <- c(
paste(c(pop[[parents$Dads[i]]][2,1:(SexRec-1)],
pop[[parents$Dads[i]]][1,SexRec:25]), collapse = ""),
paste(c(pop[[parents$Dads[i]]][1,1:(SexRec-1)],
pop[[parents$Dads[i]]][2,SexRec:25]), collapse = "")
)
Chr1Gametes <- c(
paste(c(pop[[parents$Dads[i]]][2,26:(Chr1Rec-1)],
pop[[parents$Dads[i]]][1,Chr1Rec:50]), collapse = ""),
paste(c(pop[[parents$Dads[i]]][1,26:(Chr1Rec-1)],
pop[[parents$Dads[i]]][2,Chr1Rec:50]), collapse = "")
)
Chr2Gametes <- c(
paste(c(pop[[parents$Dads[i]]][2,51:(Chr2Rec-1)],
pop[[parents$Dads[i]]][1,Chr2Rec:100]), collapse = ""),
paste(c(pop[[parents$Dads[i]]][1,51:(Chr2Rec-1)],
pop[[parents$Dads[i]]][2,Chr2Rec:100]), collapse = "")
)
# For each chromosome, randomly select ONE homolog from the two
# recombinant homologs and stick the 3 chromosomes together to create a
# haploid genome, adding this genome to the list of gametes under "sperm"
gametes$sperm[i] <- paste(c(sample(SexChrGametes, 1),
sample(Chr1Gametes, 1),
sample(Chr2Gametes, 1)), collapse = "")
}
# For female..
# Pick 3 random sites OTHER than 13, 36, and 61 in...
# Sex chromosome (2:24)
# Autosome I (27:49)
# Autosome II (52-99)
# ... at which recombination occurs (recombination CANNOT occur at first or
# final locus of a chromosome, so these loci are excluded)
SexRec <- sample(2:24, 1)
Chr1Rec <- sample(27:49, 1)
Chr2Rec <- sample(52:99, 1)
# For each chromosome, create two recombinant homologs and add to vectors
# from which gametes will be selected
SexChrGametes <- c(
paste(c(pop[[parents$Moms[i]]][2,1:(SexRec-1)],
pop[[parents$Moms[i]]][1,SexRec:25]), collapse = ""),
paste(c(pop[[parents$Moms[i]]][1,1:(SexRec-1)],
pop[[parents$Moms[i]]][2,SexRec:25]), collapse = "")
)
Chr1Gametes <- c(
paste(c(pop[[parents$Moms[i]]][2,26:(Chr1Rec-1)],
pop[[parents$Moms[i]]][1,Chr1Rec:50]), collapse = ""),
paste(c(pop[[parents$Moms[i]]][1,26:(Chr1Rec-1)],
pop[[parents$Moms[i]]][2,Chr1Rec:50]), collapse = "")
)
Chr2Gametes <- c(
paste(c(pop[[parents$Moms[i]]][2,51:(Chr2Rec-1)],
pop[[parents$Moms[i]]][1,Chr2Rec:100]), collapse = ""),
paste(c(pop[[parents$Moms[i]]][1,51:(Chr2Rec-1)],
pop[[parents$Moms[i]]][2,Chr2Rec:100]), collapse = "")
)
# For each chromosome, randomly select one homolog from the two
# recombinant homologs and stick these chromosomes together to create a
# haploid genome, adding this genome to the list of gametes under "eggs"
gametes$eggs[i] <- paste(c(sample(SexChrGametes, 1),
sample(Chr1Gametes, 1),
sample(Chr2Gametes, 1)), collapse = "")
}
# Return list of eggs and sperm
return(gametes)
}
View(pop)
MakeGametes(pop = pop, parents = parents, PARb = 15)
length(parents)
MakeGametes(pop = pop, parents = parents, PARb = 15)
# 4 make gametes
# pop = list of genomes
# parent = list of two sets of integers describing the individuals who get to
# breed
# PARb = Starting locus of pseudoautosomal region of the male sex chromosomes
# Output (gametes) = list of two sets of vectors each describing the sequence
# of a haploid gamete
MakeGametes <- function(pop, parents, PARb){
gametes <- vector(mode="list",length=2)
names(gametes) <- c("eggs","sperm")
# Iterate through each pair of parents
for(i in 1:length(parents$Dads)){
# For male...
# Check whether individual is chiasmatic or not
# TODO: Change this portion of code so individual is NOT always set as
# chiasmatic
chiasm <- T
# If individual is chiasmatic...
if(chiasm){
# Pick 3 random sites OTHER than 13, 36, and 61 in...
# PAR ((PARb+1):24)
# Autosome I (27:49)
# Autosome II (52-99)
# ... at which recombination occurs (recombination CANNOT occur at first or
# final locus of a chromosome, so these loci are excluded)
SexRec <- sample((PARb+1):24, 1)
Chr1Rec <- sample(27:49, 1)
Chr2Rec <- sample(52:99, 1)
# For each chromosome, create two recombinant homologs and add to vectors
# from which gametes will be selected
SexChrGametes <- c(
paste(c(pop[[parents$Dads[i]]][2,1:(SexRec-1)],
pop[[parents$Dads[i]]][1,SexRec:25]), collapse = ""),
paste(c(pop[[parents$Dads[i]]][1,1:(SexRec-1)],
pop[[parents$Dads[i]]][2,SexRec:25]), collapse = "")
)
Chr1Gametes <- c(
paste(c(pop[[parents$Dads[i]]][2,26:(Chr1Rec-1)],
pop[[parents$Dads[i]]][1,Chr1Rec:50]), collapse = ""),
paste(c(pop[[parents$Dads[i]]][1,26:(Chr1Rec-1)],
pop[[parents$Dads[i]]][2,Chr1Rec:50]), collapse = "")
)
Chr2Gametes <- c(
paste(c(pop[[parents$Dads[i]]][2,51:(Chr2Rec-1)],
pop[[parents$Dads[i]]][1,Chr2Rec:100]), collapse = ""),
paste(c(pop[[parents$Dads[i]]][1,51:(Chr2Rec-1)],
pop[[parents$Dads[i]]][2,Chr2Rec:100]), collapse = "")
)
# For each chromosome, randomly select ONE homolog from the two
# recombinant homologs and stick the 3 chromosomes together to create a
# haploid genome, adding this genome to the list of gametes under "sperm"
gametes$sperm[i] <- paste(c(sample(SexChrGametes, 1),
sample(Chr1Gametes, 1),
sample(Chr2Gametes, 1)), collapse = "")
}
# For female..
# Pick 3 random sites OTHER than 13, 36, and 61 in...
# Sex chromosome (2:24)
# Autosome I (27:49)
# Autosome II (52-99)
# ... at which recombination occurs (recombination CANNOT occur at first or
# final locus of a chromosome, so these loci are excluded)
SexRec <- sample(2:24, 1)
Chr1Rec <- sample(27:49, 1)
Chr2Rec <- sample(52:99, 1)
# For each chromosome, create two recombinant homologs and add to vectors
# from which gametes will be selected
SexChrGametes <- c(
paste(c(pop[[parents$Moms[i]]][2,1:(SexRec-1)],
pop[[parents$Moms[i]]][1,SexRec:25]), collapse = ""),
paste(c(pop[[parents$Moms[i]]][1,1:(SexRec-1)],
pop[[parents$Moms[i]]][2,SexRec:25]), collapse = "")
)
Chr1Gametes <- c(
paste(c(pop[[parents$Moms[i]]][2,26:(Chr1Rec-1)],
pop[[parents$Moms[i]]][1,Chr1Rec:50]), collapse = ""),
paste(c(pop[[parents$Moms[i]]][1,26:(Chr1Rec-1)],
pop[[parents$Moms[i]]][2,Chr1Rec:50]), collapse = "")
)
Chr2Gametes <- c(
paste(c(pop[[parents$Moms[i]]][2,51:(Chr2Rec-1)],
pop[[parents$Moms[i]]][1,Chr2Rec:100]), collapse = ""),
paste(c(pop[[parents$Moms[i]]][1,51:(Chr2Rec-1)],
pop[[parents$Moms[i]]][2,Chr2Rec:100]), collapse = "")
)
# For each chromosome, randomly select one homolog from the two
# recombinant homologs and stick these chromosomes together to create a
# haploid genome, adding this genome to the list of gametes under "eggs"
gametes$eggs[i] <- paste(c(sample(SexChrGametes, 1),
sample(Chr1Gametes, 1),
sample(Chr2Gametes, 1)), collapse = "")
}
# Return list of eggs and sperm
return(gametes)
}
MakeGametes(pop = pop, parents = parents, PARb = 15)
SexRec
Chr1Rec
Chr2Rec
